<?xml version="1.0" encoding="utf-8"?>

<?xml-model href="rfc7991bis.rnc"?>  <!-- Required for schema validation and schema-aware editing -->
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<!-- This third-party XSLT can be enabled for direct transformations in XML processors, including most browsers -->

<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">
]>
<!-- If further character entities are required then they should be added to the DOCTYPE above.
     Use of an external entity file is not recommended. -->
<rfc
  xmlns:xi="http://www.w3.org/2001/XInclude"
  category="info"
  docName="draft-dittakavi-rats-tdx-eat-profile-00"
  ipr="trust200902"
  obsoletes=""
  updates=""
  submissionType="independent"
  xml:lang="en"
  version="3">
  <front>
    <title abbrev="TDX EAT profile">EAT profile for Intel® Trust Domain Extensions (TDX) attestation result</title>
    <seriesInfo name="Internet-Draft" value="draft-dittakavi-rats-tdx-eat-profile-00"/>
    <author fullname="Greg Kostal" initials="G." surname="Kostal">
      <organization>Microsoft</organization>
      <address>
        <email>gkostal@microsoft.com</email>  
      </address>
    </author>
    <author fullname="Raghuram Yeluri" initials="R." surname="Yeluri">
      <organization>Intel</organization>
      <address>
        <email>raghuram.yeluri@intel.com</email>  
      </address>
    </author>
    <author fullname="Sindhuri Dittakavi" initials="S." surname="Dittakavi">
      <organization>Microsoft</organization>
      <address>
        <email>sindhuri.dittakavi@microsoft.com</email>  
      </address>
    </author>
    <author fullname="Haidong Xia" initials="H." surname="Xia">
      <organization>Intel</organization>
      <address>
        <email>haidong.xia@intel.com</email>  
      </address>
    </author>
     <author fullname="Jerry Yu" initials="J." surname="Yu">
      <organization>Intel</organization>
      <address>
        <email>jerry.yu@intel.com</email>  
      </address>
    </author>
    <date year="2023"/>
    <area>Security</area>
    <workgroup>Remote ATtestation ProcedureS</workgroup>
    <keyword>Internet-Draft</keyword>
    <abstract>
      <t>Intel® Trust Domain Extensions (Intel® TDX) introduces architectural elements designed for the deployment of hardware-isolated virtual machines (VMs) known as trust domains (TDs). TDX is designed to provide a more secure and isolated environment for running sensitive workloads or applications. The Entity Attestation Token (EAT) profile outlines claims for an Intel TDX attestation result. These claims enable a relying party to establish trust with the environment. </t>
    </abstract>
  </front>
  <middle>   
    <section>
      <name>Introduction</name>
      <t>The profile outlines the claims for an Intel® Trust Domain Extensions <xref target="TDX"/> attestation result, generated as an Entity Attestation Token <xref target="EAT"/> in a signed JSON Web Token <xref target="JWT"/> format using JOSE header. It doesn't contain nested tokens or a detached EAT bundle. The profile allows signing of the JWT token using RSA cryptographic algorithm. To facilitate verification of the signed JWT tokens, the verifier can expose the trusted token signing certificates using an OpenID metadata endpoint. In accordance with the standards outlined in the JSON Web Signature <xref target="JWS"/> specification, the receiver of the profile can use the certificate with key ID (**kid**) matching the **kid** parameter in the attestation token header for performing signature verification.</t>
    </section>
    <section>
        <name>Requirements Language</name>
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
          "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
          RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
          interpreted as described in BCP 14 <xref target="RFC2119"/>
          <xref target="RFC8174"/> when, and only when, they appear in
          all capitals, as shown here.</t>
    </section>
     <section>
        <name>TDX profile claims</name>
    <section>
        <name>JWT claims</name>
        <t>The complete definitions of the following claims are available in the IETF [JWT] specification. </t>
         <dl newline="true">
          <dt>iat:</dt>
          <dd>The "iat" (issued at) claim identifies the time at which the JWT was issued.</dd>
          <dt>exp:</dt>
          <dd>The "exp" (expiration time) claim identifies the expiration time on or after which the JWT MUST NOT be accepted for processing. </dd>
          <dt>iss:</dt>
          <dd>The "iss" (issuer) claim identifies the principal that issued the JWT.</dd>
          <dt>jti:</dt>
          <dd>The "jti" (JWT ID) claim provides a unique identifier for the JWT.</dd>
          <dt>nbf:</dt>
          <dd>The "nbf" (not before) claim identifies the time before which the JWT MUST NOT be accepted for processing. </dd>
         </dl>
     </section>
    <section>
        <name>EAT claims</name>   
       <t>The complete definitions of the following claims are available in the [EAT] specification.</t>
         <dl newline="true">
          <dt>eat_profile:</dt>
          <dd>The "eat_profile" claim identifies an EAT profile by either a URL or an OID.</dd>
          <dt>dbgstat:</dt>
          <dd>The "dbgstat" claim applies to entity-wide or submodule-wide debug facilities of the entity like [JTAG] and diagnostic hardware built into chips.</dd>
          <dt>intuse:</dt>
          <dd>The "intuse" claim provides an indication to an EAT consumer about the intended usage of the token. </dd>
          <dt>eat_nonce:</dt>
          <dd>An EAT nonce is either a byte or text string or an array of byte or text strings.  The array option supports multistage EAT verification and consumption.</dd>
         </dl>
    </section>
    <section>
        <name>TDX claims</name>
       <t>The complete definitions of the claims are available in the section **A.3.2 TD Quote Body** of Intel® TDX DCAP Quoting Library API <xref target="TDX-DCAP-Quoting-Library"/>.</t>
          <dl newline="true">
          <dt>tdx_mrsignerseam:</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the measurement of the TDX module signer, provided it is valid.</dd>
          <dt>tdx_mrseam</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the measurement of the Intel TDX module.</dd>
          <dt>tdx_mrtd</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the measurement of the initial contents of the TDX.</dd>
          <dt>tdx_rtmr0</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the runtime extendable measurement register.</dd>
          <dt>tdx_rtmr1</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the runtime extendable measurement register.</dd>
          <dt>tdx_rtmr2</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the runtime extendable measurement register.</dd>
          <dt>tdx_rtmr3</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the runtime extendable measurement register.</dd>
          <dt>tdx_mrconfigid</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the software-defined ID for non-owner-defined configuration of the TDX, e.g., runtime or Operating System (OS) configuration. </dd>
          <dt>tdx_mrowner</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the software-defined ID for the TDX’s owner.</dd>
          <dt>tdx_mrownerconfig</dt>
          <dd>The hexadecimal string represents a byte array of length 48, which contains the software-defined ID for owner-defined configuration of the TDX, e.g., specific to the workload rather than the runtime or OS.</dd>
          <dt>tdx_report_data</dt>
          <dd>The hexadecimal string corresponds to a byte array of length 64. In this context, the TDX has the flexibility to include 64 bytes of custom data in a TDX Report. For instance, this space can be used to hold a nonce, a public key, or a hash of a larger block of data.</dd>
          <dt>tdx_seam_attributes</dt>
          <dd>The hexadecimal string represents a byte array of length 8, which contains additional configuration of the TDX module.</dd>
          <dt>tdx_tee_tcb_svn</dt>
          <dd>The hexadecimal string represents a byte array of length 16, which describes the Trusted Computing Base (TCB) Security Version Numbers (SVNs) of TDX.</dd>
          <dt>tdx_xfam</dt>
          <dd>The hexadecimal string represents a byte array of length 8, which contains a mask of CPU extended features that the TDX is allowed to use.</dd>
          <dt>tdx_seamsvn</dt>
          <dd>The number represents the Intel TDX module SVN. The complete definition of the claim is available in section **3.1 SEAM_SIGSTRUCT: INTEL® TDX MODULE SIGNATURE STRUCTURE** of Intel® TDX Loader Interface Specification <xref target="TDX-Loader-Interface-Specification"/></dd>
          <dt>tdx_td_attributes</dt>
          <dd>The hexadecimal string corresponds to a byte array of length 8. These are the attributes associated with the Trust Domain (TD).  The complete definitions of the claims mentioned below are available in **A.3.4. TD Attributes** of <xref target="TDX-DCAP-Quoting-Library"/></dd>
          <dt>tdx_td_attributes_debug</dt>
          <dd>The boolean value indicates whether the TD runs in TD debug mode (set to 1) or not (set to 0). In TD debug mode, the CPU state and private memory are accessible by the host VMM.</dd>
          <dt>tdx_td_attributes_key_locker</dt>
          <dd>The boolean value indicates whether the TD is allowed to use Key Locker.</dd>
         <dt>tdx_td_attributes_perfmon</dt>
          <dd>The boolean value indicates whether the TD is allowed to use Perfmon and PERF_METRICS capabilities.</dd>
         <dt>tdx_td_attributes_protection_keys</dt>
          <dd>The boolean value incidcates whether the TD is allowed to use Supervisor Protection Keys.</dd>
         <dt>tdx_td_attributes_septve_disable</dt>
          <dd>The boolean value that determines whether to disable EPT violation conversion to #VE on TD access of PENDING pages.</dd>
          </dl>
     </section>
    <section>
        <name>Attester claims</name>
       <dl newline="true">
          <dt>attester_advisory_ids:</dt>
          <dd>Array of Advisory IDs referring to Intel security advisories that provide insight into the reason(s) for the value of tcbStatus of the platform TCB level being evaluated. See **advisoryIDs** in Intel® Trusted Services API Management Developer Portal <xref target="TDX-API-Management-Portal"/>.</dd>
          <dt>attester_tcb_status:</dt>
          <dd>The string value represents the TCB level status of the platform being evaluated. See **tcbStatus** in <xref target="TDX-API-Management-Portal"/>.</dd>
       </dl>
    </section>
    </section>
    <section anchor="IANA">
    <!-- All drafts are required to have an IANA considerations section. See RFC 8126 for a guide.-->
      <name>IANA Considerations</name>
      <t>This memo includes no request to IANA. [CHECK]</t>
    </section>
    <section anchor="Security">
      <!-- All drafts are required to have a security considerations section. See RFC 3552 for a guide. -->
      <name>Security Considerations</name>
      <t>This document should not affect the security of the Internet. [CHECK]</t>
    </section>
    <!-- NOTE: The Acknowledgements and Contributors sections are at the end of this template -->
  </middle>
  <back>
    <references>
      <name>References</name>
      <references>
        <name>Normative References</name>
        <reference anchor="EAT" target="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-21">
          <front>
            <title>The Entity Attestation Token (EAT)</title>
            <author fullname="Laurence Lundblade" initials="L." surname="Lundblade">
              <organization>Security Theory LLC</organization>
            </author>
            <author fullname="Giridhar Mandyam" initials="G." surname="Mandyam">
              <organization>Qualcomm Technologies Inc.</organization>
            </author>
            <author fullname="Jeremy O'Donoghue" initials="J." surname="O'Donoghue">
              <organization>Qualcomm Technologies Inc.</organization>
            </author>
            <author fullname="Carl Wallace" initials="C." surname="Wallace">
              <organization>Red Hound Software, Inc.</organization>
            </author>
            <date day="30" month="June" year="2023"/>
            </front>
        </reference>
         <reference anchor="JWT" target="https://datatracker.ietf.org/doc/html/rfc7519">
          <front>
            <title> JSON Web Token (JWT)</title>
            <author fullname="Michael B. Jones" initials="M." surname="Jones">
              <organization>Security Theory LLC</organization>
            </author>
            <author fullname="John Bradley" initials="J." surname="Bradley">
              <organization>Qualcomm Technologies Inc.</organization>
            </author>
            <author fullname="Nat Sakimura" initials="N." surname="Sakimura">
              <organization>Qualcomm Technologies Inc.</organization>
            </author>
            <date month="May" year="2015"/>
            </front>
        </reference>
         <reference anchor="JWS" target="https://datatracker.ietf.org/doc/html/rfc7515">
          <front>
            <title>JSON Web Signature (JWS)</title>
           <author fullname="Michael B. Jones" initials="M." surname="Jones">
              <organization>Security Theory LLC</organization>
            </author>
            <author fullname="John Bradley" initials="J." surname="Bradley">
              <organization>Qualcomm Technologies Inc.</organization>
            </author>
            <author fullname="Nat Sakimura" initials="N." surname="Sakimura">
              <organization>Qualcomm Technologies Inc.</organization>
            </author>
            <date month="May" year="2015"/>
            </front>
        </reference>
        <reference anchor="RFC2119">
          <front>
            <title>Key words for use in RFCs to Indicate Requirement Levels</title>
            <author fullname="S. Bradner" initials="S." surname="Bradner"/>
            <date month="March" year="1997"/>
          </front>
           <seriesInfo name="BCP" value="14"/>
          <seriesInfo name="RFC" value="2119"/>
          <seriesInfo name="DOI" value="10.17487/RFC2119"/>
        </reference>
        <reference anchor="RFC8174">
          <front>
            <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
            <author fullname="B. Leiba" initials="B." surname="Leiba"/>
            <date month="May" year="2017"/>
          </front>
        </reference>
      </references>
      <references>
        <name>Informative References</name>
        <reference anchor="TDX" target="https://cdrdv2.intel.com/v1/dl/getContent/690419">
          <front>
            <title>Intel® Trust Domain Extensions</title>
            <author>
              <organization>Intel</organization>
            </author>
            <date month="Feb" year="2023"/>
          </front>
        </reference>
        <reference anchor="TDX-API-Management-Portal" target="https://api.portal.trustedservices.intel.com/documentation">
          <front>
            <title>Intel® Trust Domain Extensions</title>
            <author>
              <organization>Intel</organization>
            </author>
            <date month="Feb" year="2023"/>
          </front>
        </reference>
         <reference anchor="TDX-DCAP-Quoting-Library" target="https://download.01.org/intel-sgx/latest/dcap-latest/linux/docs/Intel_TDX_DCAP_Quoting_Library_API.pdf">
          <front>
            <title>Intel® Trust Domain Extensions Data Center Attestation Primitives (Intel® TDX DCAP): Quote Generation Library and Quote Verification Library</title>
            <author>
              <organization>Intel</organization>
            </author>
            <date month="Aug" year="2023"/>
          </front>
        </reference>
         <reference anchor="TDX-Loader-Interface-Specification" target="https://cdrdv2.intel.com/v1/dl/getContent/733584">
          <front>
            <title>Intel® Trust Domain Extensions - SEAM Loader (SEAMLDR) Interface Specification</title>
            <author>
              <organization>Intel</organization>
            </author>
            <date month="Mar" year="2022"/>
          </front>
        </reference>
      </references>
    </references>
    <section>
      <name>Appendix 1 [REPLACE/DELETE]</name>
      <t>This becomes an Appendix [REPLACE]</t>
    </section>
    <section anchor="Acknowledgements" numbered="false">
      <name>Acknowledgements</name>
      <t>Thanks to Dave Thaler for reviewing the content and offering guidance in publishing the profile.</t>
    </section>
 </back>
</rfc>
